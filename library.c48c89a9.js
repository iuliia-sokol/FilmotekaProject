!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},r={},n=t.parcelRequire37c5;null==n&&((n=function(e){if(e in a)return a[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},t.parcelRequire37c5=n);var o=n("bpxeT"),i=n("2TvXO"),s=n("h6c0i"),c={library:document.querySelector(".gallery--library"),footerLink:document.querySelector(".footer__link"),footerBackDrop:document.querySelector(".footer__backdrop"),footerCloseBtn:document.querySelector("[data-modal-close]"),watchBtn:document.querySelector(".button-watched"),queueBtn:document.querySelector(".button-queue")};function l(e,t){var a=e.id,r=e.poster_path,n=e.title,o=e.release_date,i=e.vote_average.toFixed(1),s=e.poster_path?"https://image.tmdb.org/t/p/w300".concat(r):"https://m.media-amazon.com/images/M/MV5BMTRkZGE0YWYtMDFhOS00N2I4LTljMTMtYjk0MTI2YmVhOTU4XkEyXkFqcGdeQXVyNjgxNzM0NDI@._V1_.jpg",c=new Date(Date.parse(o)).getFullYear()||"";return'<li class="gallery__item gallery__item--library movie-card" data-id="'.concat(a,'">\n                  <div class="movie-card__poster-thumb">\n                    <img src="').concat(s,'"\n                        class="movie-card__poster"\n                        alt="').concat(n,'"\n                                            />\n                  </div>\n                  <div class="movie-card__wrap">\n                      <h2 class="movie-info-title movie-title-library"> ').concat(n,'</h2>\n                      <div class="movie-info-list">\n                      <p class="info-item-genre">').concat(t,'</p>\n                        <span class="info-item-slash"> | </span>\n                        <p class="info-item-year">').concat(c,'</p>\n                        <span class="info-item-vote">').concat(i,"</span>\n                      </div>\n                  </div>\n            </li>")}var d=n("X3bd8"),u=n("dKhQL"),m=n("d1Qha"),p=n("81jpj"),v=n("2ZtFH"),f=n("2doPt");function h(){c.footerBackDrop.classList.add("is-hidden"),g()}function y(e){"Escape"!==e.key&&e.target!==c.footerBackDrop||(c.footerBackDrop.classList.add("is-hidden"),g())}function g(){document.removeEventListener("keydown",y),c.footerBackDrop.removeEventListener("click",y),c.footerCloseBtn.removeEventListener("click",h),document.querySelector("body").classList.remove("noScroll")}var k=n("kGlaV"),L=new(0,d.ThemoviedbAPI);c.watchBtn.classList.add("is-active-library");try{(0,p.spinnerPlay)(),b(),window.addEventListener("scroll",u.scrollFunction),c.footerLink.addEventListener("click",(function(){c.footerBackDrop.classList.remove("is-hidden"),document.querySelector("body").classList.add("noScroll"),document.querySelector(".team").style.animation="text 2500ms linear alternate 2500ms",document.addEventListener("keydown",y),c.footerBackDrop.addEventListener("click",y),c.footerCloseBtn.addEventListener("click",h)}))}catch(e){s.Notify.failure("Ооps, something went wrong, please try again")}finally{(0,p.spinnerStop)()}function _(e){var t=document.querySelector(".js-title-queue"),a=document.querySelector(".js-library-bg-image"),r=document.querySelector("main");e.length>0&&(t.classList.add("visually-hidden"),a.classList.add("visually-hidden"),r.classList.remove("perspective")),0===e.length&&(t.classList.remove("visually-hidden"),a.classList.remove("visually-hidden"),r.classList.add("perspective"))}function b(){return w.apply(this,arguments)}function w(){return w=e(o)(e(i).mark((function t(){var a;return e(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.library.innerHTML="",_(a=(0,v.load)(L.WATCH_KEY));try{a.map((function(e){return e.id})).forEach(function(){var t=e(o)(e(i).mark((function t(a){var r,n;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.fetchMovieById(a);case 2:r=e.sent,(n=r.genres.map((function(e){return e.name}))).length>2&&n.splice(2,n.length-1,"Other"),0===n.length&&n.push("Other"),c.library.insertAdjacentHTML("beforeend",l(r,n.join(", "))),c.library.lastElementChild.setAttribute("data-status","watched");case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(e){s.Notify.failure("Ооps, something went wrong, please try again")}case 4:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}function E(){return E=e(o)(e(i).mark((function t(){var a,r;return e(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(0,p.spinnerPlay)(),c.library.innerHTML="",_(a=(0,v.load)(L.QUEUE_KEY)),r=a.map((function(e){return e.id}));try{r.forEach(function(){var t=e(o)(e(i).mark((function t(a){var r,n;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.fetchMovieById(a);case 2:r=e.sent,(n=r.genres.map((function(e){return e.name}))).length>2&&n.splice(2,n.length-1,"Other"),0===n.length&&n.push("Other"),c.library.insertAdjacentHTML("beforeend",l(r,n.join(", "))),c.library.lastElementChild.setAttribute("data-status","queue");case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(e){console.log(e),s.Notify.failure("Ооps, something went wrong, please try again")}finally{(0,p.spinnerStop)()}case 6:case"end":return t.stop()}}),t)}))),E.apply(this,arguments)}function q(){return(q=e(o)(e(i).mark((function t(a){var r,n,o;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.target.closest(".gallery__item"),e.prev=1,(0,p.spinnerPlay)(),n=r.dataset.id,o=r.dataset.status,e.next=7,L.fetchMovieById(n).then((function(e){var t=e.poster_path?"https://image.tmdb.org/t/p/w300".concat(e.poster_path):"https://m.media-amazon.com/images/M/MV5BMTRkZGE0YWYtMDFhOS00N2I4LTljMTMtYjk0MTI2YmVhOTU4XkEyXkFqcGdeQXVyNjgxNzM0NDI@._V1_.jpg",a=new Date(Date.parse(e.release_date)).getFullYear(),i={id:e.id,poster:t,title:e.title,originalTitle:e.original_title,genres:[],popularity:e.popularity.toFixed(1),overview:e.overview,vote_average:e.vote_average.toFixed(1),vote_count:e.vote_count,release_date:a};e.genres.forEach((function(e){i.genres.push(e.name)})),i.genres=i.genres.join(", "),(0,f.getTrailer)(n,L),(0,m.createModalMarkUp)(i);var l=document.querySelector(".lightbox-modal__watched-button"),d=document.querySelector(".lightbox-modal__queque-button");l.addEventListener("click",(function(e){var t=e.target.dataset.btn;(0,v.removeLocal)(L.WATCH_KEY,t),e.target.textContent="Removed from Watched",e.target.disabled=!0,e.target.dataset.list===o&&r.remove();c.watchBtn.classList.contains("is-active-library")?_((0,v.load)(L.WATCH_KEY)):_((0,v.load)(L.QUEUE_KEY));k.instance.userId&&(k.instance.removeFromLyb(+t,e.target.dataset.type),s.Notify.info("The movie removed from Watched"))})),d.addEventListener("click",(function(e){var t=e.target.dataset.btn;(0,v.removeLocal)(L.QUEUE_KEY,t),e.target.textContent="Removed from Queque",e.target.disabled=!0,e.target.dataset.list===o&&r.remove();c.watchBtn.classList.contains("is-active-library")?_((0,v.load)(L.WATCH_KEY)):_((0,v.load)(L.QUEUE_KEY));k.instance.userId&&(k.instance.removeFromLyb(+t,e.target.dataset.type),s.Notify.info("The movie removed from Queue"))})),S(L.WATCH_KEY,i,l,"Remove from Watched","watched"),S(L.QUEUE_KEY,i,d,"Remove from Queque","queue")}));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),s.Notify.failure("Ооps, something went wrong, please try again");case 13:return e.prev=13,(0,p.spinnerStop)(),e.finish(13);case 16:case"end":return e.stop()}}),t,null,[[1,9,13,16]])})))).apply(this,arguments)}function S(e,t,a,r,n){var o=(0,v.load)(e),i=t,s=o.find((function(e){return e.id===i.id}));s&&(a.dataset.list="".concat(n),a.textContent="".concat(r)),s||a.classList.add("visually-hidden")}c.watchBtn.addEventListener("click",(function(){c.queueBtn.classList.remove("is-active-library"),c.watchBtn.classList.add("is-active-library"),b()})),c.queueBtn.addEventListener("click",(function(){c.watchBtn.classList.remove("is-active-library"),c.queueBtn.classList.add("is-active-library"),function(){E.apply(this,arguments)}()})),c.library.addEventListener("click",(function(e){return q.apply(this,arguments)}));var T="light-theme",M="dark-theme",x="themeKeyLibrary",B=document.querySelector(".theme-switch__toggle"),N=document.querySelector(".cloak");B.addEventListener("change",(function(e){e.target.checked?(N.classList.add("cloak--dark"),localStorage.setItem(x,JSON.stringify(M))):(N.classList.remove("cloak--dark"),localStorage.setItem(x,JSON.stringify(T)))})),function(){var e=localStorage.getItem(x);if(e){var t=JSON.parse(e);"dark-theme"===t&&(N.classList.add("cloak--dark"),B.checked=!0),"light-theme"===t&&(N.classList.remove("cloak--dark"),B.checked=!1)}else N.classList.remove("cloak--dark"),localStorage.setItem(x,JSON.stringify(T)),B.checked=!1}()}();
//# sourceMappingURL=library.c48c89a9.js.map

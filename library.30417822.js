var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},o=e.parcelRequire37c5;null==o&&((o=function(e){if(e in t)return t[e].exports;if(e in a){var o=a[e];delete a[e];var n={id:e,exports:{}};return t[e]=n,o.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},e.parcelRequire37c5=o);var n=o("iQIUW");const r={library:document.querySelector(".gallery--library"),footerLink:document.querySelector(".footer__link"),footerBackDrop:document.querySelector(".footer__backdrop"),footerCloseBtn:document.querySelector("[data-modal-close]"),watchBtn:document.querySelector(".button-watched"),queueBtn:document.querySelector(".button-queue")};function i(e,t){const{id:a,poster_path:o,title:n,release_date:r,vote_average:i}=e,s=i.toFixed(1);return`<li class="gallery__item gallery__item--library movie-card" data-id="${a}">\n                  <div class="movie-card__poster-thumb">\n                    <img src="${e.poster_path?`https://image.tmdb.org/t/p/w300${o}`:"https://m.media-amazon.com/images/M/MV5BMTRkZGE0YWYtMDFhOS00N2I4LTljMTMtYjk0MTI2YmVhOTU4XkEyXkFqcGdeQXVyNjgxNzM0NDI@._V1_.jpg"}"\n                        class="movie-card__poster"\n                        alt="${n}"\n                                            />\n                  </div>\n                  <div class="movie-card__wrap">\n                      <h2 class="movie-info-title movie-title-library"> ${n}</h2>\n                      <div class="movie-info-list">\n                      <p class="info-item-genre">${t}</p>\n                        <span class="info-item-slash"> | </span>\n                        <p class="info-item-year">${new Date(Date.parse(r)).getFullYear()||""}</p>\n                        <span class="info-item-vote">${s}</span>\n                      </div>\n                  </div>\n            </li>`}var s=o("9ECFy"),l=o("3TVVy"),c=o("jiL1b"),d=o("ennR7"),m=o("9XPaE"),u=o("fm3FE");function y(){r.footerBackDrop.classList.add("is-hidden"),v()}function h(e){"Escape"!==e.key&&e.target!==r.footerBackDrop||(r.footerBackDrop.classList.add("is-hidden"),v())}function v(){document.removeEventListener("keydown",h),r.footerBackDrop.removeEventListener("click",h),r.footerCloseBtn.removeEventListener("click",y),document.querySelector("body").classList.remove("noScroll")}var g=o("4d3hh");const p=new(0,s.ThemoviedbAPI);r.watchBtn.classList.add("is-active-library");try{(0,d.spinnerPlay)(),L(),window.addEventListener("scroll",l.scrollFunction),r.footerLink.addEventListener("click",(function(){r.footerBackDrop.classList.remove("is-hidden"),document.querySelector("body").classList.add("noScroll"),document.querySelector(".team").style.animation="text 2500ms linear alternate 2500ms",document.addEventListener("keydown",h),r.footerBackDrop.addEventListener("click",h),r.footerCloseBtn.addEventListener("click",y)}))}catch(e){n.Notify.failure("Ооps, something went wrong, please try again")}finally{(0,d.spinnerStop)()}function f(e){const t=document.querySelector(".js-title-queue"),a=document.querySelector(".js-library-bg-image"),o=document.querySelector("main");e.length>0&&(t.classList.add("visually-hidden"),a.classList.add("visually-hidden"),o.classList.remove("perspective")),0===e.length&&(t.classList.remove("visually-hidden"),a.classList.remove("visually-hidden"),o.classList.add("perspective"))}async function L(){r.library.innerHTML="";const e=(0,m.load)(p.WATCH_KEY);f(e);try{e.map((e=>e.id)).forEach((async e=>{const t=await p.fetchMovieById(e),a=t.genres.map((e=>e.name));a.length>2&&a.splice(2,a.length-1,"Other"),0===a.length&&a.push("Other"),r.library.insertAdjacentHTML("beforeend",i(t,a.join(", "))),r.library.lastElementChild.setAttribute("data-status","watched")}))}catch(e){n.Notify.failure("Ооps, something went wrong, please try again")}}function b(e,t,a,o,n){const r=(0,m.load)(e),i=t,s=r.find((e=>e.id===i.id));s&&(a.dataset.list=`${n}`,a.textContent=`${o}`),s||a.classList.add("visually-hidden")}r.watchBtn.addEventListener("click",(()=>{r.queueBtn.classList.remove("is-active-library"),r.watchBtn.classList.add("is-active-library"),L()})),r.queueBtn.addEventListener("click",(()=>{r.watchBtn.classList.remove("is-active-library"),r.queueBtn.classList.add("is-active-library"),async function(){(0,d.spinnerPlay)(),r.library.innerHTML="";const e=(0,m.load)(p.QUEUE_KEY);f(e);const t=e.map((e=>e.id));try{t.forEach((async e=>{const t=await p.fetchMovieById(e),a=t.genres.map((e=>e.name));a.length>2&&a.splice(2,a.length-1,"Other"),0===a.length&&a.push("Other"),r.library.insertAdjacentHTML("beforeend",i(t,a.join(", "))),r.library.lastElementChild.setAttribute("data-status","queue")}))}catch(e){console.log(e),n.Notify.failure("Ооps, something went wrong, please try again")}finally{(0,d.spinnerStop)()}}()})),r.library.addEventListener("click",(async function(e){const t=e.target.closest(".gallery__item");try{(0,d.spinnerPlay)();const e=t.dataset.id,a=t.dataset.status;await p.fetchMovieById(e).then((o=>{const i=o.poster_path?`https://image.tmdb.org/t/p/w300${o.poster_path}`:"https://m.media-amazon.com/images/M/MV5BMTRkZGE0YWYtMDFhOS00N2I4LTljMTMtYjk0MTI2YmVhOTU4XkEyXkFqcGdeQXVyNjgxNzM0NDI@._V1_.jpg",s=new Date(Date.parse(o.release_date)).getFullYear(),l={id:o.id,poster:i,title:o.title,originalTitle:o.original_title,genres:[],popularity:o.popularity.toFixed(1),overview:o.overview,vote_average:o.vote_average.toFixed(1),vote_count:o.vote_count,release_date:s};o.genres.forEach((e=>{l.genres.push(e.name)})),l.genres=l.genres.join(", "),(0,u.getTrailer)(e,p),(0,c.createModalMarkUp)(l);const d=document.querySelector(".lightbox-modal__watched-button"),y=document.querySelector(".lightbox-modal__queque-button");d.addEventListener("click",(function(e){const o=e.target.dataset.btn;(0,m.removeLocal)(p.WATCH_KEY,o),e.target.textContent="Removed from Watched",e.target.disabled=!0,e.target.dataset.list===a&&t.remove();r.watchBtn.classList.contains("is-active-library")?f((0,m.load)(p.WATCH_KEY)):f((0,m.load)(p.QUEUE_KEY));g.instance.userId&&(g.instance.removeFromLyb(+o,e.target.dataset.type),n.Notify.info("The movie removed from Watched"))})),y.addEventListener("click",(function(e){const o=e.target.dataset.btn;(0,m.removeLocal)(p.QUEUE_KEY,o),e.target.textContent="Removed from Queque",e.target.disabled=!0,e.target.dataset.list===a&&t.remove();r.watchBtn.classList.contains("is-active-library")?f((0,m.load)(p.WATCH_KEY)):f((0,m.load)(p.QUEUE_KEY));g.instance.userId&&(g.instance.removeFromLyb(+o,e.target.dataset.type),n.Notify.info("The movie removed from Queue"))})),b(p.WATCH_KEY,l,d,"Remove from Watched","watched"),b(p.QUEUE_KEY,l,y,"Remove from Queque","queue")}))}catch(e){console.log(e),n.Notify.failure("Ооps, something went wrong, please try again")}finally{(0,d.spinnerStop)()}}));const _="light-theme",k="dark-theme",E=document.querySelector(".theme-switch__toggle"),w=document.querySelector(".cloak");E.addEventListener("change",(function(e){e.target.checked?(w.classList.add("cloak--dark"),localStorage.setItem("themeKeyLibrary",JSON.stringify(k))):(w.classList.remove("cloak--dark"),localStorage.setItem("themeKeyLibrary",JSON.stringify(_)))})),function(){const e=localStorage.getItem("themeKeyLibrary");if(e){const t=JSON.parse(e);"dark-theme"===t&&(w.classList.add("cloak--dark"),E.checked=!0),"light-theme"===t&&(w.classList.remove("cloak--dark"),E.checked=!1)}else w.classList.remove("cloak--dark"),localStorage.setItem("themeKeyLibrary",JSON.stringify(_)),E.checked=!1}();
//# sourceMappingURL=library.30417822.js.map
